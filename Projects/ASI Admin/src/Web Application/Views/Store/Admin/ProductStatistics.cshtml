@model asi.asicentral.web.model.store.order.OrderStatisticData

@{
    ViewBag.Title = "Statistics";
    Layout = "~/Views/Shared/_StoreLayout.cshtml";
}

<h1>Campaign Statistics</h1>
<form method="post">
    <div class="row-fluid well">
        <div class="span1">&nbsp;</div>
        <div class="span3">
            <label for="StartDate">Start Date:</label>
            <div class="input-append">
                <input class="input-medium" type="text" data-type="date" name="StartDate" value="@(Model.StartDate.HasValue ? Model.StartDate.Value.ToString("MM/dd/yyyy") : "")" /><span class="add-on"><i class="icon-remove" data-name="StartDate"></i></span></div>
        </div>
        <div class="span3">
            <label for="StartDate">End Date:</label>
            <div class="input-append">
                <input class="input-medium" type="text" data-type="date" name="EndDate" value="@(Model.EndDate.HasValue ? Model.EndDate.Value.ToString("MM/dd/yyyy") : "")" /><span class="add-on"><i class="icon-remove" data-name="EndDate"></i></span></div>
        </div>
        <div class="span2">
            <br />
            <input class="btn btn-primary" type="submit" value="Refresh" /></div>
    </div>

    @if (Model.Message != null || Model.Message == "")
    {   <div class="alert">@Model.Message</div>   }

</form>
@if (Model.Data != null && Model.Data.Count > 0)
{
    string oldGroupName = string.Empty;
    string currentGroupName = oldGroupName;
    foreach (asi.asicentral.web.model.store.order.GroupedData data in Model.Data)
    {
        currentGroupName = string.IsNullOrEmpty(data.GroupName) ? "(Unknown)" : data.GroupName;
        <text>@currentGroupName;@data.StepLabel;@data.Count<br /></text>
    }
}
@section scripts {
    @Scripts.Render("~/bundles/form")
    <script>
        $('input[data-type*="date"]').datepicker();
        $('.icon-remove').click(function (e) {
            $('input[name="' + $(e.target).data("name") + '"]').val("");
        });

        $('a[rel="download"]').click(function (e) {
            var startdate = '@Model.StartDate';
            var enddate = '@Model.EndDate';
            var location = "@Url.Action("DownloadCSV", "Orders", null)/" + "?StartDate=" + startdate + "&EndDate=" + enddate;
            document.location = location;
        });
    </script>
}